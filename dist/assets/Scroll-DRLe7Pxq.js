import{r as t,j as i,l as e}from"./index-Diha6eJ9.js";var n="undefined"!=typeof Float32Array?Float32Array:Array;function s(){var t=new n(16);return n!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function o(t,i){var e=i[0],n=i[1],s=i[2],o=i[3],r=i[4],a=i[5],c=i[6],h=i[7],l=i[8],u=i[9],m=i[10],d=i[11],f=i[12],x=i[13],v=i[14],p=i[15],A=e*a-n*r,g=e*c-s*r,P=e*h-o*r,R=n*c-s*a,M=n*h-o*a,E=s*h-o*c,T=l*x-u*f,b=l*v-m*f,w=l*p-d*f,_=u*v-m*x,I=u*p-d*x,y=m*p-d*v,D=A*y-g*I+P*_+R*w-M*b+E*T;return D?(D=1/D,t[0]=(a*y-c*I+h*_)*D,t[1]=(s*I-n*y-o*_)*D,t[2]=(x*E-v*M+p*R)*D,t[3]=(m*M-u*E-d*R)*D,t[4]=(c*w-r*y-h*b)*D,t[5]=(e*y-s*w+o*b)*D,t[6]=(v*P-f*E-p*g)*D,t[7]=(l*E-m*P+d*g)*D,t[8]=(r*I-a*w+h*T)*D,t[9]=(n*w-e*I-o*T)*D,t[10]=(f*M-x*P+p*A)*D,t[11]=(u*P-l*M-d*A)*D,t[12]=(a*b-r*_-c*T)*D,t[13]=(e*_-n*b+s*T)*D,t[14]=(x*g-f*R-v*A)*D,t[15]=(l*R-u*g+m*A)*D,t):null}function r(t,i,e){var n=i[0],s=i[1],o=i[2],r=i[3],a=i[4],c=i[5],h=i[6],l=i[7],u=i[8],m=i[9],d=i[10],f=i[11],x=i[12],v=i[13],p=i[14],A=i[15],g=e[0],P=e[1],R=e[2],M=e[3];return t[0]=g*n+P*a+R*u+M*x,t[1]=g*s+P*c+R*m+M*v,t[2]=g*o+P*h+R*d+M*p,t[3]=g*r+P*l+R*f+M*A,g=e[4],P=e[5],R=e[6],M=e[7],t[4]=g*n+P*a+R*u+M*x,t[5]=g*s+P*c+R*m+M*v,t[6]=g*o+P*h+R*d+M*p,t[7]=g*r+P*l+R*f+M*A,g=e[8],P=e[9],R=e[10],M=e[11],t[8]=g*n+P*a+R*u+M*x,t[9]=g*s+P*c+R*m+M*v,t[10]=g*o+P*h+R*d+M*p,t[11]=g*r+P*l+R*f+M*A,g=e[12],P=e[13],R=e[14],M=e[15],t[12]=g*n+P*a+R*u+M*x,t[13]=g*s+P*c+R*m+M*v,t[14]=g*o+P*h+R*d+M*p,t[15]=g*r+P*l+R*f+M*A,t}function a(t,i){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}var c=function(t,i,e,n,s){var o=1/Math.tan(i/2);if(t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=s&&s!==1/0){var r=1/(n-s);t[10]=(s+n)*r,t[14]=2*s*n*r}else t[10]=-1,t[14]=-2*n;return t};function h(t,i,e,n){var s=i[0],o=i[1],r=i[2],a=n[0],c=n[1],h=n[2],l=s-e[0],u=o-e[1],m=r-e[2],d=l*l+u*u+m*m;d>0&&(l*=d=1/Math.sqrt(d),u*=d,m*=d);var f=c*m-h*u,x=h*l-a*m,v=a*u-c*l;return(d=f*f+x*x+v*v)>0&&(f*=d=1/Math.sqrt(d),x*=d,v*=d),t[0]=f,t[1]=x,t[2]=v,t[3]=0,t[4]=u*v-m*x,t[5]=m*f-l*v,t[6]=l*x-u*f,t[7]=0,t[8]=l,t[9]=u,t[10]=m,t[11]=0,t[12]=s,t[13]=o,t[14]=r,t[15]=1,t}function l(){var t=new n(3);return n!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function u(t,i,e){var s=new n(3);return s[0]=t,s[1]=i,s[2]=e,s}function m(t,i){var e=i[0],n=i[1],s=i[2],o=e*e+n*n+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=i[0]*o,t[1]=i[1]*o,t[2]=i[2]*o,t}function d(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]}function f(t,i,e){var n=i[0],s=i[1],o=i[2],r=e[0],a=e[1],c=e[2];return t[0]=s*c-o*a,t[1]=o*r-n*c,t[2]=n*a-s*r,t}function x(t,i,e){var n=e[0],s=e[1],o=e[2],r=e[3],a=i[0],c=i[1],h=i[2],l=s*h-o*c,u=o*a-n*h,m=n*c-s*a;return l+=l,u+=u,m+=m,t[0]=a+r*l+s*m-o*u,t[1]=c+r*u+o*l-n*m,t[2]=h+r*m+n*u-s*l,t}function v(){var t=new n(4);return n!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function p(t,i,e){e*=.5;var n=Math.sin(e);return t[0]=n*i[0],t[1]=n*i[1],t[2]=n*i[2],t[3]=Math.cos(e),t}function A(t,i,e){var n=i[0],s=i[1],o=i[2],r=i[3],a=e[0],c=e[1],h=e[2],l=e[3];return t[0]=n*l+r*a+s*h-o*c,t[1]=s*l+r*c+o*a-n*h,t[2]=o*l+r*h+n*c-s*a,t[3]=r*l-n*a-s*c-o*h,t}function g(t,i,e,n){var s,o,r,a,c,h=i[0],l=i[1],u=i[2],m=i[3],d=e[0],f=e[1],x=e[2],v=e[3];return(o=h*d+l*f+u*x+m*v)<0&&(o=-o,d=-d,f=-f,x=-x,v=-v),1-o>1e-6?(s=Math.acos(o),r=Math.sin(s),a=Math.sin((1-n)*s)/r,c=Math.sin(n*s)/r):(a=1-n,c=n),t[0]=a*h+c*d,t[1]=a*l+c*f,t[2]=a*u+c*x,t[3]=a*m+c*v,t}l(),function(){var t,i=(t=new n(4),n!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();var P,R=function(t,i){var e=i[0],n=i[1],s=i[2],o=i[3],r=e*e+n*n+s*s+o*o;return r>0&&(r=1/Math.sqrt(r)),t[0]=e*r,t[1]=n*r,t[2]=s*r,t[3]=o*r,t};function M(){var t=new n(2);return n!=Float32Array&&(t[0]=0,t[1]=0),t}function E(t,i){return t[0]=i[0],t[1]=i[1],t}function T(t,i,e){return t[0]=i,t[1]=e,t}l(),u(1,0,0),u(0,1,0),v(),v(),P=new n(9),n!=Float32Array&&(P[1]=0,P[2]=0,P[3]=0,P[5]=0,P[6]=0,P[7]=0),P[0]=1,P[4]=1,P[8]=1;var b=function(t,i,e){return t[0]=i[0]-e[0],t[1]=i[1]-e[1],t},w=function(t){var i=t[0],e=t[1];return i*i+e*e};!function(){var t=M()}();class _{constructor(t,i,e){this.a=t,this.b=i,this.c=e}}class I{constructor(t,i,e){this.position=u(t,i,e),this.normal=l(),this.uv=M()}}class y{constructor(){this.vertices=[],this.faces=[]}addVertex(...t){for(let i=0;i<t.length;i+=3)this.vertices.push(new I(t[i],t[i+1],t[i+2]));return this}addFace(...t){for(let i=0;i<t.length;i+=3)this.faces.push(new _(t[i],t[i+1],t[i+2]));return this}get lastVertex(){return this.vertices[this.vertices.length-1]}subdivide(t=1){const i={};let e=this.faces;for(let n=0;n<t;++n){const t=new Array(4*e.length);e.forEach((e,n)=>{const s=this.getMidPoint(e.a,e.b,i),o=this.getMidPoint(e.b,e.c,i),r=this.getMidPoint(e.c,e.a,i),a=4*n;t[a+0]=new _(e.a,s,r),t[a+1]=new _(e.b,o,s),t[a+2]=new _(e.c,r,o),t[a+3]=new _(s,o,r)}),e=t}return this.faces=e,this}spherize(t=1){return this.vertices.forEach(i=>{m(i.normal,i.position),function(t,i,e){t[0]=i[0]*e,t[1]=i[1]*e,t[2]=i[2]*e}(i.position,i.normal,t)}),this}get data(){return{vertices:this.vertexData,indices:this.indexData,normals:this.normalData,uvs:this.uvData}}get vertexData(){return new Float32Array(this.vertices.flatMap(t=>Array.from(t.position)))}get normalData(){return new Float32Array(this.vertices.flatMap(t=>Array.from(t.normal)))}get uvData(){return new Float32Array(this.vertices.flatMap(t=>Array.from(t.uv)))}get indexData(){return new Uint16Array(this.faces.flatMap(t=>[t.a,t.b,t.c]))}getMidPoint(t,i,e){const n=t<i?`k_${i}_${t}`:`k_${t}_${i}`;if(Object.prototype.hasOwnProperty.call(e,n))return e[n];const s=this.vertices[t].position,o=this.vertices[i].position,r=this.vertices.length;return e[n]=r,this.addVertex(.5*(s[0]+o[0]),.5*(s[1]+o[1]),.5*(s[2]+o[2])),r}}class D extends y{constructor(){super();const t=.5*Math.sqrt(5)+.5;this.addVertex(-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1).addFace(0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1)}}class S extends y{constructor(t=4,i=1){super(),t=Math.max(4,t);const e=2*Math.PI/t;this.addVertex(0,0,0),this.lastVertex.uv[0]=.5,this.lastVertex.uv[1]=.5;for(let n=0;n<t;++n){const t=Math.cos(e*n),s=Math.sin(e*n);this.addVertex(i*t,i*s,0),this.lastVertex.uv[0]=.5*t+.5,this.lastVertex.uv[1]=.5*s+.5,n>0&&this.addFace(0,n,n+1)}this.addFace(0,t,1)}}function U(t,i,e){const n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,i,e),t.bindBuffer(t.ARRAY_BUFFER,null),n}class F{isPointerDown=!1;orientation=v();pointerRotation=v();rotationVelocity=0;rotationAxis=u(1,0,0);snapDirection=u(0,0,-1);snapTargetDirection;EPSILON=.1;IDENTITY_QUAT=v();constructor(t,i){this.canvas=t,this.updateCallback=i||(()=>null),this.pointerPos=M(),this.previousPointerPos=M(),this._rotationVelocity=0,this._combinedQuat=v(),t.addEventListener("pointerdown",t=>{T(this.pointerPos,t.clientX,t.clientY),E(this.previousPointerPos,this.pointerPos),this.isPointerDown=!0}),t.addEventListener("pointerup",()=>{this.isPointerDown=!1}),t.addEventListener("pointerleave",()=>{this.isPointerDown=!1}),t.addEventListener("pointermove",t=>{this.isPointerDown&&T(this.pointerPos,t.clientX,t.clientY)}),t.style.touchAction="none"}update(t,i=16){const e=t/i+1e-5;let n=e,s=v();if(this.isPointerDown){const t=.3*e,i=5/e,s=b(M(),this.pointerPos,this.previousPointerPos);if(function(t,i,e){t[0]=i[0]*e,t[1]=i[1]*e}(s,s,t),w(s)>this.EPSILON){!function(t,i,e){t[0]=i[0]+e[0],t[1]=i[1]+e[1]}(s,this.previousPointerPos,s);const t=this.#t(s),e=this.#t(this.previousPointerPos),o=m(l(),t),r=m(l(),e);E(this.previousPointerPos,s),n*=i,this.quatFromVectors(o,r,this.pointerRotation,n)}else g(this.pointerRotation,this.pointerRotation,this.IDENTITY_QUAT,t)}else{const t=.1*e;if(g(this.pointerRotation,this.pointerRotation,this.IDENTITY_QUAT,t),this.snapTargetDirection){const t=.2,i=this.snapTargetDirection,e=this.snapDirection,o=function(t,i){var e=i[0]-t[0],n=i[1]-t[1],s=i[2]-t[2];return e*e+n*n+s*s}(i,e);n*=t*Math.max(.1,1-10*o),this.quatFromVectors(i,e,s,n)}}const o=A(v(),s,this.pointerRotation);this.orientation=A(v(),o,this.orientation),R(this.orientation,this.orientation);const r=.8*e;g(this._combinedQuat,this._combinedQuat,o,r),R(this._combinedQuat,this._combinedQuat);const a=2*Math.acos(this._combinedQuat[3]),c=Math.sin(a/2);let h=0;c>1e-6&&(h=a/(2*Math.PI),this.rotationAxis[0]=this._combinedQuat[0]/c,this.rotationAxis[1]=this._combinedQuat[1]/c,this.rotationAxis[2]=this._combinedQuat[2]/c);const u=.5*e;this._rotationVelocity+=(h-this._rotationVelocity)*u,this.rotationVelocity=this._rotationVelocity/e,this.updateCallback(t)}quatFromVectors(t,i,e,n=1){const s=f(l(),t,i);m(s,s);const o=Math.max(-1,Math.min(1,d(t,i))),r=Math.acos(o)*n;return p(e,s,r),{q:e,axis:s,angle:r}}#t(t){const i=this.canvas.clientWidth,e=this.canvas.clientHeight,n=Math.max(i,e)-1,s=(2*t[0]-i-1)/n,o=(2*t[1]-e-1)/n;let r=0;const a=s*s+o*o;return r=a<=2?Math.sqrt(4-a):4/Math.sqrt(a),u(-s,o,r)}}class V{TARGET_FRAME_DURATION=1e3/60;SPHERE_RADIUS=2;#i=0;#e=0;#n=0;#s=0;camera={matrix:s(),near:.1,far:40,fov:Math.PI/4,aspect:1,position:u(0,0,3),up:u(0,1,0),matrices:{view:s(),projection:s(),inversProjection:s()}};nearestVertexIndex=null;smoothRotationVelocity=0;scaleFactor=1;movementActive=!1;constructor(t,i,e,n,s=null){this.canvas=t,this.items=i||[],this.onActiveItemChange=e||(()=>{}),this.onMovementChange=n||(()=>{}),this.#o(s)}resize(){this.viewportSize=T(this.viewportSize||M(),this.canvas.clientWidth,this.canvas.clientHeight);const t=this.gl;(function(t){const i=Math.min(2,window.devicePixelRatio),e=Math.round(t.clientWidth*i),n=Math.round(t.clientHeight*i),s=t.width!==e||t.height!==n;return s&&(t.width=e,t.height=n),s})(t.canvas)&&t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.#r(t)}run(t=0){this.#e=Math.min(32,t-this.#i),this.#i=t,this.#n=this.#e/this.TARGET_FRAME_DURATION,this.#s+=this.#n,this.#a(this.#e),this.#c(),requestAnimationFrame(t=>this.run(t))}#o(t){this.gl=this.canvas.getContext("webgl2",{antialias:!0,alpha:!1});const i=this.gl;if(!i)throw new Error("No WebGL 2 context!");this.viewportSize=function(t,i){var e=new n(2);return e[0]=t,e[1]=i,e}(this.canvas.clientWidth,this.canvas.clientHeight),this.drawBufferSize=function(t){var i=new n(2);return i[0]=t[0],i[1]=t[1],i}(this.viewportSize),this.discProgram=function(t,i,e,n){const s=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach((e,n)=>{const o=function(t,i,e){const n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(t.deleteShader(n),null)}(t,e,i[n]);o&&t.attachShader(s,o)}),n)for(const o in n)t.bindAttribLocation(s,n[o],o);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)?s:(t.deleteProgram(s),null)}(i,["#version 300 es\n\nuniform mat4 uWorldMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform vec3 uCameraPosition;\nuniform vec4 uRotationAxisVelocity;\n\nin vec3 aModelPosition;\nin vec3 aModelNormal;\nin vec2 aModelUvs;\nin mat4 aInstanceMatrix;\n\nout vec2 vUvs;\nout float vAlpha;\nflat out int vInstanceId;\n\n#define PI 3.141593\n\nvoid main() {\n    vec4 worldPosition = uWorldMatrix * aInstanceMatrix * vec4(aModelPosition, 1.);\n\n    vec3 centerPos = (uWorldMatrix * aInstanceMatrix * vec4(0., 0., 0., 1.)).xyz;\n    float radius = length(centerPos.xyz);\n\n    if (gl_VertexID > 0) {\n        vec3 rotationAxis = uRotationAxisVelocity.xyz;\n        float rotationVelocity = min(.15, uRotationAxisVelocity.w * 15.);\n        vec3 stretchDir = normalize(cross(centerPos, rotationAxis));\n        vec3 relativeVertexPos = normalize(worldPosition.xyz - centerPos);\n        float strength = dot(stretchDir, relativeVertexPos);\n        float invAbsStrength = min(0., abs(strength) - 1.);\n        strength = rotationVelocity * sign(strength) * abs(invAbsStrength * invAbsStrength * invAbsStrength + 1.);\n        worldPosition.xyz += stretchDir * strength;\n    }\n\n    worldPosition.xyz = radius * normalize(worldPosition.xyz);\n\n    gl_Position = uProjectionMatrix * uViewMatrix * worldPosition;\n\n    vAlpha = smoothstep(0.5, 1., normalize(worldPosition.xyz).z) * .9 + .1;\n    vUvs = aModelUvs;\n    vInstanceId = gl_InstanceID;\n}\n","#version 300 es\nprecision highp float;\n\nuniform sampler2D uTex;\nuniform int uItemCount;\nuniform int uAtlasSize;\n\nout vec4 outColor;\n\nin vec2 vUvs;\nin float vAlpha;\nflat in int vInstanceId;\n\nvoid main() {\n    int itemIndex = vInstanceId % uItemCount;\n    int cellsPerRow = uAtlasSize;\n    int cellX = itemIndex % cellsPerRow;\n    int cellY = itemIndex / cellsPerRow;\n    vec2 cellSize = vec2(1.0) / vec2(float(cellsPerRow));\n    vec2 cellOffset = vec2(float(cellX), float(cellY)) * cellSize;\n\n    ivec2 texSize = textureSize(uTex, 0);\n    float imageAspect = float(texSize.x) / float(texSize.y);\n    float containerAspect = 1.0;\n    \n    float scale = max(imageAspect / containerAspect, \n                     containerAspect / imageAspect);\n    \n    vec2 st = vec2(vUvs.x, 1.0 - vUvs.y);\n    st = (st - 0.5) * scale + 0.5;\n    \n    st = clamp(st, 0.0, 1.0);\n    \n    st = st * cellSize + cellOffset;\n    \n    outColor = texture(uTex, st);\n    outColor.a *= vAlpha;\n}\n"],0,{aModelPosition:0,aModelNormal:1,aModelUvs:2,aInstanceMatrix:3}),this.discLocations={aModelPosition:i.getAttribLocation(this.discProgram,"aModelPosition"),aModelUvs:i.getAttribLocation(this.discProgram,"aModelUvs"),aInstanceMatrix:i.getAttribLocation(this.discProgram,"aInstanceMatrix"),uWorldMatrix:i.getUniformLocation(this.discProgram,"uWorldMatrix"),uViewMatrix:i.getUniformLocation(this.discProgram,"uViewMatrix"),uProjectionMatrix:i.getUniformLocation(this.discProgram,"uProjectionMatrix"),uCameraPosition:i.getUniformLocation(this.discProgram,"uCameraPosition"),uScaleFactor:i.getUniformLocation(this.discProgram,"uScaleFactor"),uRotationAxisVelocity:i.getUniformLocation(this.discProgram,"uRotationAxisVelocity"),uTex:i.getUniformLocation(this.discProgram,"uTex"),uFrames:i.getUniformLocation(this.discProgram,"uFrames"),uItemCount:i.getUniformLocation(this.discProgram,"uItemCount"),uAtlasSize:i.getUniformLocation(this.discProgram,"uAtlasSize")},this.discGeo=new S(56,1),this.discBuffers=this.discGeo.data,this.discVAO=function(t,i,e){const n=t.createVertexArray();t.bindVertexArray(n);for(const[s,o,r]of i)-1!==o&&(t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,r,t.FLOAT,!1,0,0));if(e){const i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.STATIC_DRAW)}return t.bindVertexArray(null),n}(i,[[U(i,this.discBuffers.vertices,i.STATIC_DRAW),this.discLocations.aModelPosition,3],[U(i,this.discBuffers.uvs,i.STATIC_DRAW),this.discLocations.aModelUvs,2]],this.discBuffers.indices),this.icoGeo=new D,this.icoGeo.subdivide(1).spherize(this.SPHERE_RADIUS),this.instancePositions=this.icoGeo.vertices.map(t=>t.position),this.DISC_INSTANCE_COUNT=this.icoGeo.vertices.length,this.#h(this.DISC_INSTANCE_COUNT),this.worldMatrix=s(),this.#l(),this.control=new F(this.canvas,t=>this.#u(t)),this.#m(),this.#r(i),this.resize(),t&&t(this)}#l(){const t=this.gl;this.tex=function(t,i,e,n,s){const o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),o}(t,t.LINEAR,t.LINEAR,t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE);const i=Math.max(1,this.items.length);this.atlasSize=Math.ceil(Math.sqrt(i));const e=document.createElement("canvas"),n=e.getContext("2d"),s=512;e.width=this.atlasSize*s,e.height=this.atlasSize*s,Promise.all(this.items.map(t=>new Promise(i=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>i(e),e.src=t.image}))).then(i=>{i.forEach((t,i)=>{const e=i%this.atlasSize*s,o=Math.floor(i/this.atlasSize)*s;n.drawImage(t,e,o,s,s)}),t.bindTexture(t.TEXTURE_2D,this.tex),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.generateMipmap(t.TEXTURE_2D)})}#h(t){const i=this.gl;this.discInstances={matricesArray:new Float32Array(16*t),matrices:[],buffer:i.createBuffer()};for(let e=0;e<t;++e){const t=new Float32Array(this.discInstances.matricesArray.buffer,16*e*4,16);t.set(s()),this.discInstances.matrices.push(t)}i.bindVertexArray(this.discVAO),i.bindBuffer(i.ARRAY_BUFFER,this.discInstances.buffer),i.bufferData(i.ARRAY_BUFFER,this.discInstances.matricesArray.byteLength,i.DYNAMIC_DRAW);for(let e=0;e<4;++e){const t=this.discLocations.aInstanceMatrix+e;i.enableVertexAttribArray(t),i.vertexAttribPointer(t,4,i.FLOAT,!1,64,4*e*4),i.vertexAttribDivisor(t,1)}i.bindBuffer(i.ARRAY_BUFFER,null),i.bindVertexArray(null)}#a(t){const i=this.gl;this.control.update(t,this.TARGET_FRAME_DURATION);let e=this.instancePositions.map(t=>x(l(),t,this.control.orientation));e.forEach((t,i)=>{const e=.25*(Math.abs(t[2])/this.SPHERE_RADIUS*.6+.4),n=s();r(n,n,a(s(),function(t,i){return t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t}(l(),t))),r(n,n,h(s(),[0,0,0],t,[0,1,0])),r(n,n,function(t,i){return t[0]=i[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=i[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(s(),[e,e,e])),r(n,n,a(s(),[0,0,-this.SPHERE_RADIUS])),function(t,i){t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]}(this.discInstances.matrices[i],n)}),i.bindBuffer(i.ARRAY_BUFFER,this.discInstances.buffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.discInstances.matricesArray),i.bindBuffer(i.ARRAY_BUFFER,null),this.smoothRotationVelocity=this.control.rotationVelocity}#c(){const t=this.gl;t.useProgram(this.discProgram),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.uniformMatrix4fv(this.discLocations.uWorldMatrix,!1,this.worldMatrix),t.uniformMatrix4fv(this.discLocations.uViewMatrix,!1,this.camera.matrices.view),t.uniformMatrix4fv(this.discLocations.uProjectionMatrix,!1,this.camera.matrices.projection),t.uniform3f(this.discLocations.uCameraPosition,this.camera.position[0],this.camera.position[1],this.camera.position[2]),t.uniform4f(this.discLocations.uRotationAxisVelocity,this.control.rotationAxis[0],this.control.rotationAxis[1],this.control.rotationAxis[2],1.1*this.smoothRotationVelocity),t.uniform1i(this.discLocations.uItemCount,this.items.length),t.uniform1i(this.discLocations.uAtlasSize,this.atlasSize),t.uniform1f(this.discLocations.uFrames,this.#s),t.uniform1f(this.discLocations.uScaleFactor,this.scaleFactor),t.uniform1i(this.discLocations.uTex,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.tex),t.bindVertexArray(this.discVAO),t.drawElementsInstanced(t.TRIANGLES,this.discBuffers.indices.length,t.UNSIGNED_SHORT,0,this.DISC_INSTANCE_COUNT)}#m(){h(this.camera.matrix,this.camera.position,[0,0,0],this.camera.up),o(this.camera.matrices.view,this.camera.matrix)}#r(t){this.camera.aspect=t.canvas.clientWidth/t.canvas.clientHeight;const i=.35*this.SPHERE_RADIUS,e=this.camera.position[2];this.camera.aspect>1?this.camera.fov=2*Math.atan(i/e):this.camera.fov=2*Math.atan(i/this.camera.aspect/e),c(this.camera.matrices.projection,this.camera.fov,this.camera.aspect,this.camera.near,this.camera.far),o(this.camera.matrices.inversProjection,this.camera.matrices.projection)}#u(t){const i=t/this.TARGET_FRAME_DURATION+1e-4;let e=5/i,n=3;const s=this.control.isPointerDown||Math.abs(this.smoothRotationVelocity)>.01;if(s!==this.movementActive&&(this.movementActive=s,this.onMovementChange(s)),this.control.isPointerDown)n+=80*this.control.rotationVelocity+2.5,e=7/i;else{const t=this.#d(),i=t%Math.max(1,this.items.length);this.onActiveItemChange(i);const e=m(l(),this.#f(t));this.control.snapTargetDirection=e}this.camera.position[2]+=(n-this.camera.position[2])/e,this.#m()}#d(){const t=this.control.snapDirection,i=function(t,i){return t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t[3]=i[3],t}(v(),this.control.orientation),e=x(l(),t,i);let n,s=-1;for(let o=0;o<this.instancePositions.length;++o){const t=d(e,this.instancePositions[o]);t>s&&(s=t,n=o)}return n}#f(t){const i=this.instancePositions[t];return x(l(),i,this.control.orientation)}}const L=[{image:"https://picsum.photos/900/900?grayscale",link:"https://google.com/",title:"",description:""}];function C({items:e=[]}){const n=t.useRef(null),[s,o]=t.useState(null),[r,a]=t.useState(!1);t.useEffect(()=>{const t=n.current;let i;const s=t=>{const i=t%e.length;o(e[i])};t&&(i=new V(t,e.length?e:L,s,a,t=>t.run()));const r=()=>{i&&i.resize()};return window.addEventListener("resize",r),r(),()=>{window.removeEventListener("resize",r)}},[e]);return i.jsxs("div",{className:"relative w-full h-full",children:[i.jsx("canvas",{id:"infinite-grid-menu-canvas",ref:n,className:"cursor-grab w-full h-full overflow-hidden relative outline-none active:cursor-grabbing"}),s&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:`\n          select-none\n          absolute\n          font-black\n          text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl\n          left-3 sm:left-4 md:left-6 lg:left-8 xl:left-10\n          top-[45%] sm:top-1/2\n          transform\n          translate-x-1/4\n          -translate-y-1/2\n          transition-all\n          ease-[cubic-bezier(0.25,0.1,0.25,1.0)]\n          ${r?"opacity-0 pointer-events-none duration-[100ms]":"opacity-100 pointer-events-auto duration-[500ms]"}\n        `,children:s.title}),i.jsx("p",{className:`\n          select-none\n          absolute\n          max-w-[12ch] sm:max-w-[15ch] md:max-w-[18ch] lg:max-w-[22ch] xl:max-w-[28ch]\n          text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl\n          top-[55%]\n          right-1 sm:right-2 md:right-4 lg:right-6 xl:right-8\n          transition-all\n          ease-[cubic-bezier(0.25,0.1,0.25,1.0)]\n          ${r?"opacity-0 pointer-events-none duration-[100ms] translate-x-[-50%] -translate-y-1/2":"opacity-100 pointer-events-auto duration-[500ms] translate-x-[-90%] -translate-y-1/2"}\n        `,children:s.description}),i.jsx("div",{onClick:()=>{s?.link&&s.link.startsWith("http")&&window.open(s.link,"_blank")},className:`\n          absolute\n          left-1/2\n          z-10\n          w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 lg:w-20 lg:h-20 xl:w-24 xl:h-24\n          grid place-items-center\n          bg-[#ff0000]\n          border-4 sm:border-5 md:border-6 lg:border-8 xl:border-10 border-black\n          rounded-full\n          cursor-pointer\n          shadow-lg\n          hover:scale-110 active:scale-95\n          transition-transform duration-300 ease-[cubic-bezier(0.25,0.1,0.25,1.0)]\n          ${r?"bottom-[-80px] opacity-0 pointer-events-none duration-[100ms] scale-0 -translate-x-1/2":"bottom-[4em] sm:bottom-[3.8em] md:bottom-[4em] lg:bottom-[4.5em] xl:bottom-[5em] opacity-100 pointer-events-auto duration-[500ms] scale-100 -translate-x-1/2"}\n        `,children:i.jsx("p",{className:"select-none relative text-[#060010] top-[2px] text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl",children:"â†—"})})]})]})}function z(){const t=[{image:e,link:"https://www.youtube.com/@adadarsh23",title:"YouTube",description:"Watch videos and explore content."},{image:"/assets/insta-DfgTjsCq.png",link:"https://www.instagram.com/adadarsh23/",title:"Instagram",description:"Share photos and stories."},{image:"/assets/spotify-D_PSz9Uq.png",link:"https://open.spotify.com/artist/7nd9x69ZcOpoft6TMDnXCa",title:"Spotify",description:"Listen to music and podcasts."},{image:"/assets/git-fH-nSCaL.jpg",link:"https://github.com/adadarsh23",title:"GitHub",description:"Explore my projects and contributions."}];return i.jsx("section",{className:"bg-black",children:i.jsx("div",{className:"pt-10 pb-10",children:i.jsx(C,{items:t})})})}export{z as default};
