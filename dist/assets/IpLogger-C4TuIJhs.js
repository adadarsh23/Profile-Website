import{r as u}from"./vendor_react-EZwwNu31.js";import{al as p,am as g}from"./vendor-DBGwnfOc.js";const I="https://tppissuzgiecmtejvcyy.supabase.co",m="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwcGlzc3V6Z2llY210ZWp2Y3l5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzOTk2MjksImV4cCI6MjA3NTk3NTYyOX0.y0m02BaKdPyeM3yvM8vJlIgljw37TwjN4Okvete_6U0",w=p(I,m);async function c(o,i=3,e=500){try{return await o()}catch(n){if(i<=0)throw n;return await new Promise(r=>setTimeout(r,e)),c(o,i-1,e*2)}}function h(){return u.useEffect(()=>{const o=new AbortController,i=o.signal;let e=!0;return(async()=>{if(!localStorage.getItem("visitorLogged"))try{const r="https://ipapi.co/json/",s=await c(()=>fetch(r,{signal:i}),3,500);if(!s.ok)throw new Error("IP API error: ".concat(s.status));const t=await s.json();if(!(t!=null&&t.ip))throw new Error("IP data missing");const l={unique_id:g(),ip:t.ip,city:t.city,region:t.region,country:t.country_name,user_agent:navigator.userAgent,timestamp:new Date().toISOString()},{error:a}=await w.from("Producer").insert([l]);if(a)throw a;e&&localStorage.setItem("visitorLogged","true")}catch(r){r.name!=="AbortError"&&console.error("Visitor data logging failed:",r)}})(),()=>{e=!1,o.abort()}},[]),null}export{h as default};
