import{g as t,r,v as e}from"./vendor-CAHoof4P.js";const n=t("https://tppissuzgiecmtejvcyy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwcGlzc3V6Z2llY210ZWp2Y3l5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzOTk2MjksImV4cCI6MjA3NTk3NTYyOX0.y0m02BaKdPyeM3yvM8vJlIgljw37TwjN4Okvete_6U0");async function retry(t,r=3,e=500){try{return await t()}catch(n){if(r<=0)throw n;return await new Promise(t=>setTimeout(t,e)),retry(t,r-1,2*e)}}function IpLogger(){return r.useEffect(()=>{const t=new AbortController,r=t.signal;let o=!0;return(async()=>{if(!localStorage.getItem("visitorLogged"))try{const t="https://ipapi.co/json",i=await retry(()=>fetch(t,{signal:r}),3,500);if(!i.ok)throw new Error(`IP API error: ${i.status}`);const a=await i.json();if(!a?.ip)throw new Error("IP data missing");const s={unique_id:e(),ip:a.ip,city:a.city||"Unknown",region:a.region||"Unknown",country:a.country_name||"Unknown",user_agent:navigator.userAgent,timestamp:(new Date).toISOString()},{error:c}=await n.from("Producer").insert([s]);if(c)throw c;o&&localStorage.setItem("visitorLogged","true")}catch(t){if("AbortError"===t.name)return}})(),()=>{o=!1,t.abort()}},[]),null}export{IpLogger as default};
