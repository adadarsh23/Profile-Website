import{r as u}from"./vendor_react-BVve6nW_.js";import{al as g,am as p}from"./vendor-CBjGBlE2.js";const I="https://tppissuzgiecmtejvcyy.supabase.co",m="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwcGlzc3V6Z2llY210ZWp2Y3l5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzOTk2MjksImV4cCI6MjA3NTk3NTYyOX0.y0m02BaKdPyeM3yvM8vJlIgljw37TwjN4Okvete_6U0",w=g(I,m);async function c(o,i=3,e=500){try{return await o()}catch(s){if(i<=0)throw s;return await new Promise(t=>setTimeout(t,e)),c(o,i-1,e*2)}}function h(){return u.useEffect(()=>{const o=new AbortController,i=o.signal;let e=!0;return(async()=>{if(!localStorage.getItem("visitorLogged"))try{const t="https://ipapi.co/json",n=await c(()=>fetch(t,{signal:i}),3,500);if(!n.ok)throw new Error("IP API error: ".concat(n.status));const r=await n.json();if(!(r!=null&&r.ip))throw new Error("IP data missing");const l={unique_id:p(),ip:r.ip,city:r.city||"Unknown",region:r.region||"Unknown",country:r.country_name||"Unknown",user_agent:navigator.userAgent,timestamp:new Date().toISOString()},{error:a}=await w.from("Producer").insert([l]);if(a)throw a;e&&localStorage.setItem("visitorLogged","true")}catch(t){if(t.name==="AbortError")return;console.error("Visitor data logging failed:",t.message||t)}})(),()=>{e=!1,o.abort()}},[]),null}export{h as default};
